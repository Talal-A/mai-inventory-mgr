#!/usr/bin/with-contenv bash

# Restore the data database if it does not already exist.
if [ -f /data/mai.db ]; then
	echo "mai.db already exists, skipping restore"
else
	echo "No mai.db found, restoring from replica if exists"
	exec litestream restore -v -if-replica-exists -replica s3 /data/mai.db 
fi

# Restore the log database if it does not already exist.
if [ -f /data/mai-log.db ]; then
	echo "mai-log.db already exists, skipping restore"
else
	echo "No mai-log.db found, restoring from replica if exists"
	exec litestream restore -v -if-replica-exists -replica s3 /data/mai-log.db 
fi